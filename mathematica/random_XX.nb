(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     16261,        399]
NotebookOptionsPosition[     15528,        367]
NotebookOutlinePosition[     15863,        382]
CellTagsIndexPosition[     15820,        379]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Random XX chain: entanglement entropy", "Section",
 CellChangeTimes->{{3.662029031053401*^9, 3.6620290441899643`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"L", "=", "128"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ll", "=", "64"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"shift", "=", "32"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"nsample", "=", "5"}], ";", "\n", 
    RowBox[{"data", "=", 
     RowBox[{"{", "}"}]}], ";", "\n", 
    RowBox[{"Monitor", "[", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"n", "=", "1"}], ",", 
       RowBox[{"n", "\[LessEqual]", "nsample"}], ",", 
       RowBox[{"n", "++"}], ","}], "\[IndentingNewLine]"}]}]}], "*)"}], 
  RowBox[{
   RowBox[{"JJ", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"RandomReal", "[", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"L", "-", "1"}]}], "}"}]}], "]"}]}], 
   ";"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JJ", "=", 
   RowBox[{"{", 
    RowBox[{
    "0.185082", ",", "0.931541", ",", "0.947731", ",", "0.484749", ",", 
     "0.320536", ",", "0.154427", ",", "0.698863", ",", "0.119951", ",", 
     "0.485176", ",", "0.632738", ",", "0.818227", ",", "0.683026", ",", 
     "0.498561", ",", "0.586797", ",", "0.719754", ",", "0.258498", ",", 
     "0.546207", ",", "0.407308", ",", "0.176985", ",", "0.969632", ",", 
     "0.297018", ",", "0.287869", ",", "0.116193", ",", "0.181727", ",", 
     "0.49429", ",", "0.565765", ",", "0.221835", ",", "0.767491", ",", 
     "0.577308", ",", "0.167823", ",", "0.367471", ",", "0.468674", ",", 
     "0.654266", ",", "0.79309", ",", "0.663062", ",", "0.61303", ",", 
     "0.990852", ",", "0.119485", ",", "0.148565", ",", "0.852281", ",", 
     "0.509526", ",", "0.21727", ",", "0.993266", ",", "0.315297", ",", 
     "0.258733", ",", "0.809175", ",", "0.353675", ",", "0.467842", ",", 
     "0.274173", ",", "0.7982", ",", "0.814138", ",", "0.94809", ",", 
     "0.822885", ",", "0.515139", ",", "0.220998", ",", "0.746631", ",", 
     "0.431538", ",", "0.888304", ",", "0.941193", ",", "0.503012", ",", 
     "0.702042", ",", "0.706542", ",", "0.481022", ",", "0.960314", ",", 
     "0.426023", ",", "0.322874", ",", "0.76193", ",", "0.932629", ",", 
     "0.711217", ",", "0.517431", ",", "0.884472", ",", "0.553634", ",", 
     "0.573642", ",", "0.393933", ",", "0.926547", ",", "0.00554442", ",", 
     "0.728499", ",", "0.355754", ",", "0.212933", ",", "0.362027", ",", 
     "0.8783", ",", "0.363326", ",", "0.503207", ",", "0.767488", ",", 
     "0.914476", ",", "0.826368", ",", "0.411746", ",", "0.630843", ",", 
     "0.341912", ",", "0.381693", ",", "0.96246", ",", "0.647014", ",", 
     "0.957846", ",", "0.803452", ",", "0.229386", ",", "0.879202", ",", 
     "0.592496", ",", "0.786172", ",", "0.532144", ",", "0.968291", ",", 
     "0.574954", ",", "0.476843", ",", "0.421138", ",", "0.59898", ",", 
     "0.106573", ",", "0.368608", ",", "0.215806", ",", "0.807211", ",", 
     "0.798221", ",", "0.554539", ",", "0.895146", ",", "0.92914", ",", 
     "0.977633", ",", "0.917719", ",", "0.0400112", ",", "0.732822", ",", 
     "0.896374", ",", "0.837831", ",", "0.536454", ",", "0.321319", ",", 
     "0.397254", ",", "0.277439", ",", "0.936248", ",", "0.463743", ",", 
     "0.852289", ",", "0.212767", ",", "0.000123584"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AppendTo", "[", 
   RowBox[{"JJ", ",", "0"}], "]"}], ";", 
  RowBox[{"T", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"i", ",", 
          RowBox[{"j", "-", "1"}]}], "]"}], " ", 
        RowBox[{"JJ", "\[LeftDoubleBracket]", 
         RowBox[{"j", "-", "1"}], "\[RightDoubleBracket]"}]}], "2."], "+", 
      FractionBox[
       RowBox[{
        RowBox[{"KroneckerDelta", "[", 
         RowBox[{"i", ",", 
          RowBox[{"j", "+", "1"}]}], "]"}], " ", 
        RowBox[{
        "JJ", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}]}], 
       "2."]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "L"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "L"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"Spect", "=", 
   RowBox[{"Eigensystem", "[", "T", "]"}]}], ";", 
  RowBox[{"ind", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "L"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"eigval", "=", 
   RowBox[{"Spect", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
  ";", 
  RowBox[{"ind", "=", 
   RowBox[{"Select", "[", 
    RowBox[{"ind", ",", 
     RowBox[{
      RowBox[{
       RowBox[{
       "eigval", "\[LeftDoubleBracket]", "#1", "\[RightDoubleBracket]"}], "<",
        "0"}], "&"}]}], "]"}]}], ";", 
  RowBox[{"eigvec", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Spect", "\[LeftDoubleBracket]", 
      RowBox[{"2", ",", 
       RowBox[{
       "ind", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]}], 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", 
       RowBox[{"Length", "[", "ind", "]"}]}], "}"}]}], "]"}]}], ";", 
  RowBox[{
   RowBox[{"Corr", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"Total", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"eigvec", "\[LeftDoubleBracket]", 
        RowBox[{"q", ",", "x"}], "\[RightDoubleBracket]"}], " ", 
       RowBox[{"eigvec", "\[LeftDoubleBracket]", 
        RowBox[{"q", ",", "y"}], "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"q", ",", "1", ",", 
        RowBox[{"Length", "[", "eigvec", "]"}]}], "}"}]}], "]"}], "]"}]}], 
  ";", 
  RowBox[{"ent", "=", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"k", "=", "1"}], ",", 
    RowBox[{"k", "\[LessEqual]", 
     FractionBox["L", "4"]}], ",", 
    RowBox[{"k", "++"}], ",", 
    RowBox[{
     RowBox[{"shift", "=", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"L", "-", 
         RowBox[{"2", " ", "k"}]}], ")"}]}]}], ";", 
     RowBox[{"ll", "=", 
      RowBox[{"2", " ", "k"}]}], ";", 
     RowBox[{"cmat", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Corr", "[", 
         RowBox[{
          RowBox[{"shift", "+", "x"}], ",", 
          RowBox[{"shift", "+", "y"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "1", ",", "ll"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "1", ",", "ll"}], "}"}]}], "]"}]}], ";", 
     RowBox[{"eeig", "=", 
      RowBox[{"Eigenvalues", "[", "cmat", "]"}]}], ";", 
     RowBox[{"Ent", "=", 
      RowBox[{
       UnderoverscriptBox["\[Sum]", 
        RowBox[{"i", "=", "1"}], 
        RowBox[{"Length", "[", "eeig", "]"}]], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
            "eeig", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "]"}], ">", "0"}], "&&", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{
            "eeig", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "]"}], "<", "1"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{
             "eeig", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
             ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"-", 
             RowBox[{"Log", "[", 
              RowBox[{"1", "-", 
               RowBox[{
               "eeig", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "]"}]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{
           "eeig", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           " ", 
           RowBox[{"Log", "[", 
            RowBox[{
            "eeig", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "]"}]}]}], ",", "0"}], "]"}]}]}], ";", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"ent", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"2", "k"}], ",", "Ent"}], "}"}]}], "]"}], ";"}]}], "]"}], 
  ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"data", ",", "ent"}], "]"}], ";"}], "]"}], ";"}], ",", 
     RowBox[{"{", "n", "}"}]}], "]"}], "*)"}], "\n"}]}], "Input",
 CellChangeTimes->{{3.662029048693681*^9, 3.6620290784370604`*^9}, {
   3.662029183491638*^9, 3.662029445910842*^9}, {3.662029503219943*^9, 
   3.662029504267785*^9}, {3.6620297988806553`*^9, 3.6620299092353687`*^9}, {
   3.662030014363248*^9, 3.662030015064962*^9}, {3.6620301272570477`*^9, 
   3.662030129934855*^9}, {3.662030620196767*^9, 3.662030621509884*^9}, {
   3.662031373486953*^9, 3.6620313738604794`*^9}, {3.662031416701989*^9, 
   3.662031426363648*^9}, {3.662031470564344*^9, 3.66203147098654*^9}, {
   3.662031523195222*^9, 3.662031523521723*^9}, {3.662032021584943*^9, 
   3.6620321156371593`*^9}, {3.6620326780512533`*^9, 3.662032695642825*^9}, {
   3.662032786711129*^9, 3.6620328908630466`*^9}, {3.662032929094111*^9, 
   3.662033076819509*^9}, {3.662033124986395*^9, 3.662033386708867*^9}, {
   3.66203370588505*^9, 3.6620338848029613`*^9}, {3.662033917051626*^9, 
   3.66203392045014*^9}, {3.66203395049925*^9, 3.6620339507138643`*^9}, {
   3.662034022456264*^9, 3.662034027712906*^9}, {3.662034063848836*^9, 
   3.662034154125988*^9}, {3.662034342631784*^9, 3.6620344045773706`*^9}, {
   3.662034439329855*^9, 3.662034442280574*^9}, 3.6620346654682617`*^9, {
   3.662034904583743*^9, 3.662034907717648*^9}, {3.6620349632308064`*^9, 
   3.6620349668265142`*^9}, {3.662035006830035*^9, 3.66203501241728*^9}, {
   3.662035081628744*^9, 3.662035084559958*^9}, {3.662035299127988*^9, 
   3.662035302265481*^9}, {3.6620353688584013`*^9, 3.662035372677555*^9}, {
   3.662035422993516*^9, 3.6620354292969637`*^9}, {3.6620354855320787`*^9, 
   3.6620354880669107`*^9}, {3.662035728943139*^9, 3.66203573237047*^9}, {
   3.6620357686777363`*^9, 3.6620358054276447`*^9}, {3.662035885107683*^9, 
   3.662035917065995*^9}, {3.662036005205142*^9, 3.662036034734934*^9}, {
   3.6620361380626097`*^9, 3.662036140746279*^9}, {3.662036191709444*^9, 
   3.662036193969596*^9}, {3.662036256927908*^9, 3.662036260893276*^9}, {
   3.662036426452436*^9, 3.662036430151495*^9}, {3.662036546657927*^9, 
   3.662036549188822*^9}, {3.6620370674271727`*^9, 3.662037081690462*^9}, {
   3.6620374667669897`*^9, 3.66203749959341*^9}, {3.6620375708386583`*^9, 
   3.662037592935968*^9}, {3.6620377592811527`*^9, 3.662037798528419*^9}, {
   3.662037833907711*^9, 3.662037975705756*^9}, {3.662038151917795*^9, 
   3.662038219271467*^9}, {3.662038796498074*^9, 3.662038874003736*^9}, 
   3.662038905081388*^9, 3.6620389679430723`*^9, 3.662039715880127*^9, {
   3.6620402946027203`*^9, 3.6620403005597477`*^9}, {3.662040411089641*^9, 
   3.662040459720355*^9}, {3.662040507584153*^9, 3.662040512087009*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ex", "=", 
   RowBox[{
   "Import", "[", 
    "\"\</u/he/valba/Github/negatitivy/ran_negativity/mathematica/re\>\"", 
    "]"}]}], " ", ";"}]], "Input",
 CellChangeTimes->{{3.66203965704393*^9, 3.6620396776478558`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ex", "[", 
  RowBox[{"[", "3", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6620396791157913`*^9, 3.662039696519425*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"{1.383628902159025\"\>", ",", "1.810545890967248`", ",", 
   "1.432479004724228`", ",", "1.3951627770324266`", ",", 
   "1.6298257160720162`", ",", "1.4262773557917467`", ",", "2.1353031347007`",
    ",", "\<\" 1.9119885950487108 + 1.2599858674912698*^-15*I\"\>", ",", 
   "1.5724474941812188`", ",", "2.0677474692514335`", 
   ",", "\<\" 1.7872774326297372 + 1.0931349472878151*^-15*I\"\>", 
   ",", "\<\" 1.8953178403155464 + 6.270384076621184*^-16*I\"\>", 
   ",", "\<\" 1.5083824124404257 + 1.0328330607015858*^-15*I\"\>", 
   ",", "\<\" 2.3908333110367845 + 2.2602515226747766*^-15*I\"\>", 
   ",", "\<\" 1.6209414088484106 + 8.380312721548843*^-16*I\"\>", 
   ",", "\<\" 2.0796521755145303 + 3.3801724110061083*^-15*I\"\>", 
   ",", "\<\" 2.3465777886053774 + 6.294449863093254*^-15*I\"\>", 
   ",", "\<\" 2.0830824875998535 + 3.4699650337039792*^-15*I\"\>", 
   ",", "\<\" 2.6915301511084624 + 4.385245803933934*^-15*I\"\>", 
   ",", "\<\" 1.4907855842373379 + 6.094734018503764*^-15*I\"\>", 
   ",", "\<\" 2.744899475597132 + 5.591985963694587*^-15*I\"\>", 
   ",", "\<\" 2.3544245124874816 + 4.2675088586950095*^-15*I\"\>", 
   ",", "\<\" 2.9118718558914036 + 4.263126614193246*^-15*I\"\>", 
   ",", "\<\" 2.8706538777475843 + 4.431545177104931*^-15*I\"\>", 
   ",", "\<\" 2.914714925111556 + 6.7334731402088055*^-15*I\"\>", 
   ",", "\<\" 2.4456069508659812 + 7.487711922975561*^-15*I\"\>", 
   ",", "\<\" 2.0425310810482507 + 6.087491532021622*^-15*I\"\>", 
   ",", "\<\" 2.2290157939759454 + 7.079765827709471*^-15*I\"\>", 
   ",", "\<\" 2.550930015304841 + 8.25982165869359*^-15*I\"\>", 
   ",", "\<\" 2.205144265321108 + 5.996650565533444*^-15*I\"\>", 
   ",", "\<\" 1.4079009468506314 + 1.1378284051590499*^-14*I\"\>", 
   ",", "\<\" 2.4447667325285 + 9.100254901487923*^-15*I}\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.662039681322133*^9, 3.662039696983383*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ent", "//", "ListPlot"}]], "Input",
 CellChangeTimes->{{3.662040470176856*^9, 3.6620404784455137`*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGBQAGIQDQEf7F9ZJqazTX5oDxVwMMg8Ix3E+gXK53AIDRLy
653xE8oXcPgpe8RLzvQXlC/i8LVO1WOG9x8oX8JBzrk9QEUIpl7Gwabm1tsM
NxhfwaGpVeij03WYfiUHp3CjrWwrv0P5Kg5zz8zm373wB5Sv5vD/xYMvQjX/
oXwNh0kf/zROfvgNytdy2LP2v8mMxH9Qvo7Dm0qdgNe2v6F8PYfZhd/9LuXB
7Ddw2O8cUFSx7y+Ub+iQcXBnTGwsjG/kECviWb/BGWaesQMv+1eenctg5pk4
3NELUi1mYXCA8E0d/G48mDwngwXKN3M4vCKssO4NTN7cYUnqp4jj+oxQvoXD
03qFT5q8bFC+pcPPaX42Sddh6q0cJF0nvXi5DeZfa4fPBiEqgSLsUHkbh7tt
GR1PW5mgfFuHwHvRD7onsUL5dg6VEua1f9/A3GPvYGetf7XjEMx+B4eDKs1H
pjKyOgAAsZmKGQ==
      "]]}, {}}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{},
  PlotRange->{{0., 32.}, {0, 2.884920390910446}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.662040471034272*^9, 3.662040479006743*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1106, 877},
WindowMargins->{{Automatic, 322}, {Automatic, 19}},
FrontEndVersion->"10.2 for Linux x86 (64-bit) (July 6, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[422, 15, 124, 1, 68, "Section"],
Cell[549, 18, 11019, 254, 945, "Input"],
Cell[11571, 274, 254, 7, 32, "Input"],
Cell[CellGroupData[{
Cell[11850, 285, 146, 3, 32, "Input"],
Cell[11999, 290, 1931, 30, 297, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13967, 325, 127, 2, 32, "Input"],
Cell[14097, 329, 1403, 34, 248, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

